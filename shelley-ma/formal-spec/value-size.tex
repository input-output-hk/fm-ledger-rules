\section{Output Size}
\label{sec:value-size}

In Shelley, the protocol parameter $\var{minUTxOValue}$ is used to
disincentivize attacking nodes by putting many small outputs on the
UTxO, permanently blocking memory. Because members of the $\Value$
type can be arbitrary large, the ledger requires a $\UTxO$ entry to
contain a minimum amount of Ada, proportional to its size.

\begin{figure*}[h]
  \emph{Constants}
  \begin{align*}
  \mathsf{UtxoEntrySizeWithoutVal} \in \MemoryEstimate \\
  \mathsf{AdaOnlyUTxOSize} \in \MemoryEstimate
  \mathsf{MaxValSize} \in \MemoryEstimate
  \end{align*}
  %
  \emph{Helper Functions}
  \begin{align*}
    & \fun{adaPerUTxOByte}~\in \PParams \to \Coin \\
    & \fun{adaPerUTxOByte}~pp = \fun{quot}~ (\fun{minUTxOValue}~pp, \mathsf{adaOnlyUTxOSize}) \\
    & \text{Calculate the cost of storing a memory unit of data as a UTxO entry} \\~\\
    %
    & \fun{utxoEntrySize} \in \TxOut \to \MemoryEstimate \\
    & \fun{utxoEntrySize}~\var{out} = \mathsf{utxoEntrySizeWithoutVal} + (\fun{size} (\fun{getValue}~out)) \\
    & \text{Calculate the size of a UTxO entry}
  \end{align*}
  \caption{Value Size}
  \label{fig:test}
\end{figure*}

How much memory is used exactly is an implementation detail, with the current constants, in Haskell words (8 bytes):
\begin{itemize}
  \item $\mathsf{utxoEntrySizeWithoutVal} = 27$
  \item $\mathsf{adaOnlyUTxOSize} = 27$
  \item $\mathsf{MaxValSize} = 500$ words, ie. 4000 bytes.
\end{itemize}

We do not give the specifics of the $\fun{size}$ function here, because
we left the implementation of $\Value$ itself non-specific. This calculation
influences how much users have to send each
other for transactions to be valid, so having a function that a user
can easily evaluate by themselves is important.
